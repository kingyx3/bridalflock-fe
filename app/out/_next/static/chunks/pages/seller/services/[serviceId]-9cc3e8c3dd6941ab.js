(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[918],{9054:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/seller/services/[serviceId]",function(){return s(57)}])},57:function(e,t,s){"use strict";s.r(t);var r=s(5893),i=s(7294),a=s(1163),l=s(1701),n=s(9611),c=s(9033),o=s(2947);let d={title:"",category:"",subCategory:"",description:"",searchTags:[],images:[],serviceType:"online",location:null,deliveryDays:"",tiers:[],addons:[],disabled:!1};t.default=function(){let[{user:e}]=(0,l.C4)(),t=(0,a.useRouter)(),{serviceId:s,groupIndex:u}=t.query,[g,x]=(0,i.useState)(d),[h,m]=(0,i.useState)(!0),[v,p]=(0,i.useState)(Date.now());(0,i.useEffect)(()=>{if(s&&(null==e?void 0:e.uid)){let r=async()=>{m(!0);try{let r=await (0,n.ko)(s);if(r){if(r.userId!==e.uid){o.Am.error("You are not authorized to edit this service."),t.push("/seller/services");return}let s={...d,title:r.title||"",category:r.category||"",subCategory:r.subCategory||"",description:r.description||"",searchTags:r.searchTags||[],images:r.images||[],serviceType:r.serviceType||"online",location:r.location||null,deliveryDays:r.deliveryDays||"",tiers:r.tiers||[],addons:r.addons||[],disabled:r.disabled||!1};for(let e in r)Object.prototype.hasOwnProperty.call(r,e)&&!Object.prototype.hasOwnProperty.call(s,e)&&(s[e]=r[e]);x(s),p(Date.now())}else o.Am.error("Service not found."),t.push("/seller/services")}catch(e){console.error("Error fetching service details:",e),o.Am.error("Failed to load service data. "+(e.message||"")),t.push("/seller/services")}finally{m(!1)}};r()}else s||(o.Am.error("Service ID not provided."),t.push("/seller/services"),m(!1))},[s,t,null==e?void 0:e.uid,u]);let y=async e=>{if(m(!0),null==u){o.Am.error("Group index is missing. Cannot update service."),m(!1);return}try{let r=e.images||[],i={...e,images:r};delete i.currentStep,await (0,n.Vp)(s,{...i,groupIndex:parseInt(String(u),10)}),o.Am.success("Service updated successfully!"),t.push("/seller/services")}catch(e){console.error("Error updating service:",e),o.Am.error("Failed to update service. "+(e.message||"Something went wrong."))}finally{m(!1)}};return(!h||g.title||g.images&&0!==g.images.length||""!==g.category)&&s&&(null==e?void 0:e.uid)?h||g.title&&""!==g.category?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"text-center mb-10",children:[(0,r.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"Edit Your Service"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Update the details of your service listing."})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-xl rounded-2xl p-6 sm:p-8",children:[!h&&g.title&&g.category&&(0,r.jsx)(c.Z,{initialData:g,onSubmit:y,isEditMode:!0,serviceId:s,user:e,setParentLoading:m},v),h&&(0,r.jsx)("div",{className:"text-center dark:text-white py-10",children:"Loading form..."})]})]})}):(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center min-h-screen",children:[(0,r.jsx)("div",{className:"text-xl text-red-500 dark:text-red-400",children:"Service not found or failed to load."}),(0,r.jsx)("button",{onClick:()=>t.push("/seller/services"),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Go to My Services"})]}):(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("div",{className:"text-xl dark:text-white",children:"Loading service details or waiting for user info..."})})}}},function(e){e.O(0,[33,774,888,179],function(){return e(e.s=9054)}),_N_E=e.O()}]);