(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[917],{8157:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/seller/services",function(){return t(5204)}])},5204:function(e,s,t){"use strict";t.r(s);var r=t(5893),a=t(1664),l=t.n(a),d=t(5675),c=t.n(d),i=t(7294),n=t(1701),o=t(751),x=t(6100);s.default=function(){let[{user:e}]=(0,n.C4)(),[s,t]=(0,i.useState)(-1),[a,d]=(0,i.useState)([]),[m,u]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!0),[y,v]=(0,i.useState)(0),f=async s=>{if(!(null==e?void 0:e.uid)){console.log("User UID not available for fetching services."),u(!1);return}u(!0);try{let r=(0,x.JU)(o.db,"users",e.uid,"userSellerServices",String(s)),a=await (0,x.QT)(r);if(a.exists()){let e=a.data(),r=Object.keys(e).filter(s=>!s.startsWith("_")&&e[s]&&"object"==typeof e[s]&&e[s].id).map(t=>({...e[t],groupIndex:s}));r.sort((e,s)=>{var t,r,a,l;let d=(null===(t=e.createdAt)||void 0===t?void 0:t.seconds)||(null===(r=e.createdAt)||void 0===r?void 0:r._seconds)||("number"==typeof e.createdAt?e.createdAt:0),c=(null===(a=s.createdAt)||void 0===a?void 0:a.seconds)||(null===(l=s.createdAt)||void 0===l?void 0:l._seconds)||("number"==typeof s.createdAt?s.createdAt:0);return c-d}),d(e=>{let t=new Set(e.map(e=>e.id)),a=r.filter(e=>!t.has(e.id));if(0===s){let s=e.filter(e=>0!==e.groupIndex);return[...s,...a].sort((e,s)=>{var t,r;return((null===(t=s.createdAt)||void 0===t?void 0:t.seconds)||0)-((null===(r=e.createdAt)||void 0===r?void 0:r.seconds)||0)})}return[...e,...a].sort((e,s)=>{var t,r;return((null===(t=s.createdAt)||void 0===t?void 0:t.seconds)||0)-((null===(r=e.createdAt)||void 0===r?void 0:r.seconds)||0)})}),t(s),s+1>=Math.ceil(y/100)||0===y?h(!1):h(!0)}else h(!1),0===s&&y>0&&console.warn("Group 0 not found for user ".concat(e.uid," but totalServices is ").concat(y,". This might indicate an issue."))}catch(t){console.error("Error fetching service group ".concat(s," for user ").concat(null==e?void 0:e.uid,":"),t),h(!1)}finally{u(!1)}};return(0,i.useEffect)(()=>{let s=async()=>{if(!(null==e?void 0:e.uid)){d([]),v(0),t(-1),h(!1);return}u(!0),d([]),t(-1);try{let s=(0,x.JU)(o.db,"users",e.uid,"userSellerServicesMetadata","summary"),t=await (0,x.QT)(s),r=0;t.exists()?(r=t.data().totalServicesCount||0,v(r)):v(0),r>0?(h(!0),await f(0)):h(!1)}catch(s){console.error("Error fetching initial service data for user ".concat(e.uid,":"),s),h(!1),v(0)}finally{u(!1)}};s()},[null==e?void 0:e.uid]),(0,r.jsxs)("div",{className:"min-h-[80vh] my-10 mt-0 px-4 sm:px-6 md:px-8 lg:px-16 xl:px-24 py-6",children:[(0,r.jsx)("h3",{className:"mb-4 sm:mb-6 text-2xl font-semibold dark:text-white",children:"All your Services"}),(0,r.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,r.jsxs)("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:"Service"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:"Category"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:"Price"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:"Duration"}),(0,r.jsx)("th",{scope:"col",className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:(0,r.jsx)("span",{className:"sr-only",children:"Edit"})})]})}),(0,r.jsx)("tbody",{children:a.map(e=>{let{title:s,category:t,price:a,durationHours:d,id:i,mainImage:n}=e;return(0,r.jsxs)("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,r.jsx)("td",{className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:n&&(0,r.jsx)(c(),{className:"h-full w-full rounded-full object-cover",src:n,width:40,height:40,alt:"Service Image"})}),(0,r.jsx)("div",{className:"dark:text-gray-100 font-medium",children:s})]})}),(0,r.jsx)("td",{className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:t}),(0,r.jsxs)("td",{className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:["$",a]}),(0,r.jsxs)("td",{className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4",children:[d||"N/A"," Hours"]}),(0,r.jsx)("td",{className:"px-3 py-2 sm:px-4 sm:py-3 md:px-6 md:py-4 text-right",children:(0,r.jsx)(l(),{href:"/seller/services/".concat(i,"?groupIndex=").concat(e.groupIndex),className:"font-medium text-blue-600 dark:text-blue-500 hover:underline",children:"Edit"})})]},i)})})]})}),m&&(0,r.jsx)("div",{className:"text-center my-4 dark:text-white",children:"Loading services..."}),!m&&p&&y>0&&a.length<y&&(0,r.jsx)("div",{className:"flex justify-center my-6",children:(0,r.jsx)("button",{onClick:()=>f(s+1),className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",disabled:m,children:"Load More Services"})}),!m&&!p&&a.length>0&&y>0&&a.length===y&&(0,r.jsx)("div",{className:"text-center my-4 text-gray-500 dark:text-gray-400",children:"No more services to load."}),!m&&0===y&&(0,r.jsxs)("div",{className:"text-center my-10 text-xl text-gray-500 dark:text-gray-300",children:["You have no services yet. ",(0,r.jsx)(l(),{href:"/seller/services/create",className:"text-blue-500 hover:underline",children:"Create one!"})]}),!m&&0===a.length&&y>0&&(0,r.jsx)("div",{className:"text-center my-10 text-xl text-gray-500 dark:text-gray-300",children:"Could not load services. Please try again later or check your connection."})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8157)}),_N_E=e.O()}]);